<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      Head in the Sandbox &middot; finleye
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/styles.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="finleye" href="/atom.xml">
</head>


  <body>

    <div class="container content">
      <header class="masthead">
        <a href="/about">
          <img src="/assets/images/prof-pic-a.jpg" class="avatar" align="left" />
        </a>
        <h3 class="masthead-title">
          <a href="/" title="Home">finleye</a>
          <small>Ruby on Rails Dev</small>
        </h3>
      </header>

      <main>
        <article class="post">
  <h1 class="post-title">Head in the Sandbox</h1>
  <time datetime="2016-01-15T09:00:00-05:00" class="post-date">15 Jan 2016</time>
  <p>I spent way to much time banging my head against my keyboard when I was getting empty responses from Instagram’s API, and hopefully I can help some of you avoid doing the same. I’ll quickly outline some of Instagram’s sandbox API limitations and what to expect.</p>

<h4 id="but-this-call-works">But this call works?</h4>

<p>In my <a href="/sinatra/instagram/2016/01/14/instagram-integration.html">previous post</a> I talked about setting up Instagram API integration in a [Sinatra][insatra] app. And I quickly hit a wall. I was able to get the <code class="highlighter-rouge">#user_recent_media</code> call working no issue. I signed in as myself and was able to see my recent posts. So I moved on to my main goal, which was searching the API by location. I added some coordinates for Manhattan and got <em>nothing</em>…</p>

<p>Here’s how it went</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">insta_client</span> <span class="o">=</span> <span class="no">Instagram</span><span class="p">.</span><span class="nf">client</span><span class="p">(</span><span class="ss">access_token: </span><span class="n">some_token</span><span class="p">)</span></code></pre></figure>

<p>Great. I have a client.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">insta_client</span><span class="p">.</span><span class="nf">user_recent_media</span><span class="p">.</span><span class="nf">media</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="no">Media</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="no">Media</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="no">Media</span><span class="o">&gt;</span><span class="p">,</span> <span class="p">.</span><span class="nf">.</span><span class="o">.</span><span class="p">]</span></code></pre></figure>

<p>Great! Plenty of pictures!</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">insta_client</span><span class="p">.</span><span class="nf">media_search</span><span class="p">(</span><span class="s1">'40.7127'</span><span class="p">,</span> <span class="s1">'74.0059'</span><span class="p">,</span> <span class="ss">distance: </span><span class="mi">5000</span><span class="p">).</span><span class="nf">media</span>
<span class="o">=&gt;</span> <span class="p">[]</span></code></pre></figure>

<p>Nothing…</p>

<p>I looked at the call. I was getting a 200. No problems with the authentication. No network issues.</p>

<p>I spent some time searching the web and found the smoking gun. It was <em><a href="https://www.instagram.com/developer/sandbox/">sandbox mode</a></em>!</p>

<h4 id="maybe-read-the-api-docs">Maybe read the API Docs</h4>

<p>As it turns out, in November of 2015, Instagram changed their API so that all new apps start in sandbox mode when using the API, until they are approved. This limits your interactions with the API in a few ways, but the problem here was that I wanted public data (scope key <code class="highlighter-rouge">public_data</code>), but in sandbox mode “public” means public data from your applications users. So, you only get public data from users who have been invited to test your app, and authorized the app for <code class="highlighter-rouge">public_data</code>.</p>

<p>After searching for coordinates for an area I had tagged images for, I was able to get images.</p>

<p>Then after looking at the docs for sandbox mode, I found this;</p>

<blockquote>
  <p>The response returned by this endpoint will contain only media with the given tag, as expected. But instead of returning media from any public Instagram user, it will return only media that belongs to your sandbox users, restricted to the last 20 for each user.</p>
</blockquote>

<p>In the end, <a href="https://en.wikipedia.org/wiki/RTFM">RTFM</a>.</p>

<p>Up next, adding a couple rails conveniences to Sinatra. Until then, feel free to contact me on <a href="https://twitter.com/cfinley">twitter</a> or <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#102;&#105;&#110;&#108;&#101;&#121;&#046;&#099;&#111;&#114;&#101;&#121;&#064;&#103;&#109;&#097;&#105;&#108;&#046;&#099;&#111;&#109;">email</a> me. See you soon!</p>


</article>


<aside class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/sinatra/2016/01/24/controllers.html">
            Implementing Sinatra Controllers
            <small><time datetime="2016-01-24T09:00:00-05:00">24 Jan 2016</time></small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/sinatra/2016/01/19/haml-and-partials.html">
            HAML and Partials
            <small><time datetime="2016-01-19T09:00:00-05:00">19 Jan 2016</time></small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/elixir/scheme/2016/01/16/other-languages.html">
            There's Always More to Learn
            <small><time datetime="2016-01-16T09:00:00-05:00">16 Jan 2016</time></small>
          </a>
        </h3>
      </li>
    
  </ul>
</aside>


      </main>

      <footer class="footer">
  <div>
    <a href="/about">About me</a>
    <a href="https://github.com/finleye"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">finleye</span></a>

    <a href="https://twitter.com/cfinley"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">cfinley</span></a>

  </div>
  <small>
    &copy; <time datetime="2016-01-24T16:41:35-05:00">2016</time>. All rights reserved.
  </small>
  <small>
    <a href="/disclaimer">Disclaimer</a>
  </small>
</footer>

      <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42037834-2', 'auto');
  ga('send', 'pageview');

</script>

    </div>
  </body>
</html>
